(()=>{const e=document.getElementById("canvas");e.width=800,e.height=800;const t=64;e.addEventListener("mousedown",(function(e){const s=m(e);console.log(s);for(let e of i)if(e.x<=s.x&&e.x+t>=s.x&&e.y<=s.y&&e.y+t>=s.y){c=e;break}})),e.addEventListener("mousemove",(function(e){if(!c)return;const t=m(e);c.x=t.x-32,c.y=t.y-32})),e.addEventListener("mouseleave",_),e.addEventListener("mouseup",_);const s=e.getContext("2d");setInterval((function(){s.fillStyle="white",s.fillRect(0,0,800,800),s.fillStyle="black";for(let e of i)s.drawImage(n[e.id],e.x,e.y),s.fillText(o[e.id],e.x,e.y+t+12),s.fillText(d[e.id],e.x,e.y+t+24)}),40);const o={forest:"Лес",negative:"Негатив",work:"Работа",money:"Деньги",water:"Влага",wind:"Ветер",tester:"Тестировщик",pivko:"Пив&ко",anton:"Антоша",ants:"Муравьи",cigarettes:"Сигареты",dm:"Дядя Миша",dm_dead:"Мертвый Дядя Миша",dm_dead_eight:"Восемь мертвых Дядей Миш",dm_dead_four:"Четвыре мертвых Дяди Мишей",dm_dead_six:"Шесть мертвых Дядей Миш",dm_dead_two:"Два метрвых Дяди Миши",dm_dressed:"Одетый Дядя Миша",dm_wet:"Влажный Дядя Миша",persimmon:"Хурма",persimmon_with_ants:"Хурма с муравьями",portal:"Портвл в Ад",wolf:"Волк",wolf_two:"Два волка",wolf_four:"Четыре волка",blob:"Blob",lobster:"Лобствер",blobster:"Блобстер",frog:"Жаба",il_blob:"Илюха Блобстер",wolfpack_1:"Дядя Миша и три волка",wolfpack_2:"Антоша, Дядя миша и два волка",wolfpack_3:"Блобстер, Антоша, Дядя миша и волк",wolfpack_4:"Стая",victory:"Победа",online_prince:"Онлайн-принц",anton_anteater:"Антоша Муравьед"};let r=[{first:"negative",second:"work",result:"money"},{first:"wind",second:"money",result:"tester"},{first:"money",second:"water",result:"pivko"},{first:"dm",second:"water",result:"dm_wet"},{first:"dm_wet",second:"wind",result:"dm_dead"},{first:"tester",second:"work",result:"persimmon"},{first:"tester",second:"forest",result:"ants"},{first:"persimmon",second:"ants",result:"persimmon_with_ants"},{first:"work",second:"water",result:"forest"},{first:"dm_wet",second:"wind",result:"dm_dead4"},{first:"cigarettes",second:"tester",result:"anton"},{first:"negative",second:"tester",result:"dm"},{first:"ants",second:"persimmon",result:"persimmon_with_ants"},{first:"money",second:"pivko",result:"cigarettes"},{first:"dm_dead_six",second:"dm_dead_four",result:"portal"},{first:"dm_dead_eight",second:"dm_dead_two",result:"portal"},{first:"dm_dead",second:"dm_dead",result:"dm_dead_two"},{first:"dm_dead_two",second:"dm_dead_two",result:"dm_dead_four"},{first:"dm_dead_two",second:"dm_dead_four",result:"dm_dead_six"},{first:"dm_dead_six",second:"dm_dead_two",result:"dm_dead_eight"},{first:"dm_dead_four",second:"dm_dead_four",result:"dm_dead_eight"},{first:"forest",second:"negative",result:"wolf"},{first:"wolf",second:"wolf",result:"wolf_two"},{first:"wolf_two",second:"wolf_two",result:"wolf_four"},{first:"wolf_four",second:"dm",result:"wolfpack_1"},{first:"wolfpack_1",second:"anton_anteater",result:"wolfpack_2"},{first:"wolfpack_2",second:"il_blob",result:"wolfpack_3"},{first:"wolfpack_3",second:"online_prince",result:"wolfpack_4"},{first:"wolfpack_4",second:"portal",result:"victory"},{first:"anton",second:"persimmon_with_ants",result:"anton_anteater"},{first:"negative",second:"money",result:"online_prince"},{first:"money",second:"work",result:"blob"},{first:"blob",second:"lobster",result:"blobster"},{first:"forest",second:"water",result:"frog"},{first:"frog",second:"water",result:"lobster"},{first:"blobster",second:"frog",result:"il_blob"}],d={};for(let e of r)d[e.first]=d[e.first]?d[e.first]+1:1,d[e.second]=d[e.second]?d[e.second]+1:1;const n={};for(let e in o){const t=new Image;t.src=`./images/${e}.png`,n[e]=t}let i=[{x:200,y:400,id:"water",isEternal:!0,startX:200,startY:400},{x:300,y:400,id:"wind",isEternal:!0,startX:300,startY:400},{x:400,y:400,id:"negative",isEternal:!0,startX:400,startY:400},{x:500,y:400,id:"work",isEternal:!0,startX:500,startY:400}];const l=document.getElementById("save-button"),a=document.getElementById("load-button"),f="alchemy-save";a.disabled=!window.localStorage.getItem(f),l.onclick=function(){const e={field:i,recipies:r};window.localStorage.setItem(f,JSON.stringify(e)),a.disabled=!1},a.onclick=function(){const e=JSON.parse(window.localStorage.getItem(f));i=e.field,r=e.recipies,d={};for(let e of r)d[e.first]=d[e.first]?d[e.first]+1:1,d[e.second]=d[e.second]?d[e.second]+1:1};let c=null;function _(e){if(c){e:for(let e of i)if(e!==c&&!(e.x+t<=c.x||c.x+t<e.x||e.y+t<c.y||c.y+t<e.y)){console.log(`Found intersection with ${e.id}`);for(let s of r)if(s.first===c.id&&s.second===e.id||s.second===c.id&&s.first===e.id){if(!s.found){s.found=!0,d[s.first]--,d[s.second]--;const e=document.createElement("p");e.innerText=`${o[s.first]} + ${o[s.second]} = ${o[s.result]}`,document.getElementById("recipies").appendChild(e)}i=i.filter((t=>t.isEternal||t!==e&&t!==c)),e.isEternal?i.push({x:e.x,y:e.y-t-16,id:s.result}):i.push({x:c.x,y:c.y,id:s.result});break e}}c.isEternal&&(c.x=c.startX,c.y=c.startY),c=null}}function m(t){const s=e.getBoundingClientRect();return{x:t.clientX-s.left,y:t.clientY-s.top}}})();